<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">

    <title>Random (and probably useless) Rubyisms</title>

    <meta name="description" content="Random (and probably useless) Rubyisms">
    <meta name="author" content="Miguel Palhas">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="css/reveal.min.css">
    <link rel="stylesheet" href="css/theme/custom.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- If the query includes 'print-pdf', include the PDF print sheet -->
    <script>
      if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
      }
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>

  <body>

    <div class="reveal">

<!-- Any section element inside of this container is displayed as a slide -->
<div class="slides">
<section data-markdown><script type="text/template">
# Random
# (and probably useless)
# Rubyisms
</script></section>


<section data-markdown><script type="text/template">
![gb logo](img/groupbuddies.png)

# Miguel Palhas

# `@naps62`
</script></section>


<section>
  <h1>Disclaimer</h1>

  <div class="stretch">
    <br>
    <p>Some of these stuff...</p>

    <ul>
      <li>... might really be useless</li>
      <li>... is probably not the best approach</li>
    </ul>
  </div>
</section>


<section>
  <h1><code class="ruby">attr_accessor</code></h1>

  <pre><code class="ruby">
class X
  def attr_reader :something
end

class Y
  def something; @something; end
end
  </code></pre>
</section>


<section data-markdown><script type="text/template">
# Inline `rescue`

```ruby
user = { first_name: 'Professor' }

user[:last_name].underscore
  # NoMethodError for nil:NilClass

user[:last_name].underscore rescue "CHIBANGA"
  # falls back to "CHIBANGA"
```
</script></section>


<section data-markdown><script type="text/template">
# Retry

Calls the `(begin..rescue)` block once again

```
begin
  some_dangerous_stuff
rescue AnException => e
  retry
end
```
</script></section>

<section data-markdown><script type="text/template">
# Retry
```
def insist(max_attempts: 3, &block)
  begin
    attempts = 0
    yield
  rescue SomeException => e
    attempts += 1
    retry if attempts < max_attempts
  end
end
```
</script></section>


<section>
  <h1>Lambdas quack like hashes</h1>

<pre><code class="ruby">
fibs = -> x { (x <= 1) ? 1 : fibs[x-1] + fibs[x-2] }

fibs.call(20)

fibs[20]
</code></pre>
</section>


<section data-markdown><script type="text/template">
# Faster RegEx extraction

```ruby
str = "GB is not Great Britain"

# the usual way
match_results = str.match /(GB)/
match_results[1]
=> "GB"
```

But also:

```ruby
str[/(GB)/, 1]
```
</script></section>


<section>
  <h1>Array or single element?</h1>

<pre class="fragment"><code class="ruby">
class Post < ActiveRecord::Base; end

result  = Post.find(1)
=> #&lt;Post:...&gt;

results = Post.find(1, 2)
=> [#&lt;Post:...&gt;, #&lt;Post:...&gt;]
</code></pre>

<span class="fragment">What if we don't know?</span>
<pre class="fragment"><code class="ruby">
results = Post.find(*ids)

[*results].map do |post|
  # ...
end
</code></pre>
</script></section>



<section>
<h1>Unary operators</h1>

<p class="fragment">+, -, ! and ~ can be overriden</p>
<pre class="fragment"><code class="ruby">
class Counter
  def initialize
    @value = 0
  end

  def +@
    @value += 1
  end

  def -@
    @value -= 1
  end

  def ~
    @value
  end
end
</code></pre>

<pre class="fragment"><code class="ruby">
c = Counter.new
+c
+c
puts ~c # 2
</code></pre>
</section>

<section>
  <h1>Method Madness</h1>
  <p>How far can we go?</p>
</section>


<section>
<h1>Method Madness</h1>
<pre><code class="ruby">
def m1(a, b=1)        # correct

</code><code class="fragment ruby">
def m2(a=1, b)        # correct

</code><code class="fragment ruby">
def m3(a, b=2, c)     # correct

</code><code class="fragment ruby">
def m4(a=1, b, c=3)   # wrong (optional args must be sequential)

</code><code class="fragment ruby">
def m5(a, b=2, *args) # correct

</code><code class="fragment ruby">
def m6(a=1, b, *args) # wrong

</code></pre>
</section>


<section>
  <h1>Method Madness</h1>

  <div class="stretch">
    <pre><code class="ruby">
def m7(*args, c)      # correct

def tail(*args, last)
  last
end
    </code><code class="fragment ruby">
def m8(a, b=1, *args, d, e: 1, f:, **named_args, &block) # correct

    </code><code class="fragment ruby">
# blocks are just as powerful
define_method 'm9' do |*args, **named_args, &block|
end

    </code><code class="fragment ruby">
def m8(a, b=1, *args, d, e: 1, f:, **named_args, &block) # correct

    </code><code class="fragment ruby">
define_method ' ' do
  "this actually works!"
end

send(' ')
=&gt; "this actually works!"
    </code></pre>
  </div>
</section>

<section>
  <h1>Modules</h1>
  <p>How do they work?</p>
</section>


<section>
  <h1>Modules</h1>

  <div class="stretch">
    <div class="c50">
      <pre><code class="ruby">
class MyClass
end
      </code></pre>
    </div>
    <div class="c50">
      <img src="img/modules_1.svg" alt="modules 1" />
    </div>
  </div>
</section>


<section>
  <h1>Modules</h1>

  <div class="stretch">
    <div class="c50">
      <pre><code class="ruby">
class MyClass
  include MyModule
end
      </code></pre>
    </div>
    <div class="c50">
      <img src="img/modules_2.svg" alt="modules 2" />
    </div>
  </div>
</section>


<section>
  <h1>Modules</h1>

  <div class="stretch">
    <div class="c50">
      <pre><code class="ruby">
class MyClass
  include MyModule
  include AnotherModule
end
      </code></pre>
    </div>
    <div class="c50">
      <img src="img/modules_3.svg" alt="modules 3" />
    </div>
  </div>
</section>


<section>
  <h1>Modules</h1>

  <div class="stretch">
    <div class="c50">
      <pre><code class="ruby">
class MyClass
  prepend Prepended
end
      </code></pre>
    </div>
    <div class="c50">
      <img src="img/modules_4.svg" alt="modules 4" />
    </div>
  </div>
</section>


<section>
  <h1>Lexical Scope</h1>

  <div class="stretch">
    <div class="fragment">
      <div class="c50">
        <pre><code class="ruby">
  def m; end
        </code></pre>
      </div>
      <div class="c50">
        Defined in global scope (an instance of Object)
      </div>
    </div>

    <div class="fragment">
      <div class="c50">
        <pre><code class="ruby">
  Class MyClass
    def m; end
  end
        </code></pre>
      </div>
      <div class="c50">
        Defined in MyClass
      </div>
    </div>

    <div class="fragment">
      <div class="c50">
        <pre><code class="ruby">
  Class MyClass
    def self.m; end
  end
        </code></pre>
      </div>
      <div class="c50">
        ???
      </div>
    </div>
  </div>
</section>

<section>
  <h1>The Metaclass</h1>

  <div class="stretch">
    <div class="fragment">
      <div class="c50">
        <pre><code class="ruby">
Array.class
=&gt; Class
        </code></pre>
      </div>
      <div class="c50">
        <pre><code class="ruby">
[].class
=&gt; MyClass
        </code></pre>
      </div>
    </div>

    <div class="fragment">
      <div class="c50">
        <pre><code class="ruby">
Array.singleton_class
=&gt; &lt;Class:MyClass&gt;
        </code></pre>
      </div>
      <div class="c50">
        <pre><code class="ruby">
[].singleton_class
=&gt; &lt;Class:#&lt;MyClass:0x007f86d8d6e370&gt;&gt;
        </code></pre>
      </div>
    </div>
  </div>
</section>


<section>
  <h1>Defining metaclass methods</h1>

  <div class="stretch">
    <div class="fragment">
      <div class="c50">
        <pre><code class="ruby">
class Array
  def self.m; end
end
        </code></pre>
      </div>
      <div class="c50">
        Defined in Array's metaclass
      </div>
    </div>

    <div class="fragment">
      <div class="c50">
        <pre><code class="ruby">
def Array.m; end
        </code></pre>
      </div>
      <div class="c50">
        Same as above
      </div>
    </div>

    <div class="fragment">
      <div class="c50">
        <pre><code class="ruby">
class &lt;&lt; Array
  def m; end
end
        </code></pre>
      </div>
      <div class="c50">
        Same as above
      </div>
    </div>

    <div class="fragment">
      <div class="c50">
        <pre><code class="ruby">
class Array
  class &lt;&lt; self
    def m; end
  end
end
        </code></pre>
      </div>
      <div class="c50">
        Same as above
      </div>
    </div>
  </div>
</section>

<section>
  <h1>Defining metaclass methods</h1>

  <div class="stretch">
    <div class="fragment">
      <div class="c50">
        <pre><code class="ruby">
a = Array.new
def a.m; end
        </code></pre>
      </div>
      <div class="c50">
        Defined in a's metaclass
      </div>
    </div>

    <div class="fragment">
      <div class="c50">
        <pre><code class="ruby">
a = Array.new
class &lt;&lt; a
  def m; end
end
        </code></pre>
      </div>
      <div class="c50">
        Same as above
      </div>
    </div>
  </div>
</section>


<section>
  <h1>Thank you!</h1>
  <p>http://naps62.github.io/presentations</p>
</section>


    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.min.js"></script>

    <script>

      // Full list of configuration options available here:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: false,
        progress: true,
        history: true,
        center: true,
        overview: false,

        theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        transition: Reveal.getQueryHash().u || 'linear', // default/cube/page/concave/zoom/linear/fade/none

        // Parallax scrolling
        // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
        // parallaxBackgroundSize: '2100px 900px',

        // Optional libraries used to extend on reveal.js
        dependencies: [
          { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
          { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
          { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
        ]
      });

    </script>

  </body>
</html>
